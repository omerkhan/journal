---
interface Props {
  title?: string;
  date: Date;
  slug: string;
  image?: string | null;
  location?: string;
  excerpt: string;
}

const { title, date, slug, image, location, excerpt } = Astro.props;

const formattedDate = date.toLocaleDateString('en-US', {
  month: 'long',
  day: 'numeric',
  year: 'numeric',
});

const hasImage = !!image;
---

<article class="group">
  <a href={`/posts/${slug}`} class="block no-underline">
    {hasImage && (
      <div class="mb-4 overflow-hidden rounded-lg">
        <img
          src={image}
          alt=""
          class="w-full h-auto object-cover transition-transform duration-300 group-hover:scale-[1.02]"
          loading="lazy"
        />
      </div>
    )}

    <div class:list={[
      'transition-colors duration-200',
      !hasImage && 'p-6 bg-surface rounded-lg border border-border group-hover:border-accent/30'
    ]}>
      {title && (
        <h2 class="font-serif text-xl sm:text-2xl text-text-primary group-hover:text-accent transition-colors duration-200 mb-2">
          {title}
        </h2>
      )}

      <p class="text-text-secondary text-sm mb-3">
        {formattedDate}
        {location && <> &middot; {location}</>}
      </p>

      <p class:list={[
        'text-text-primary leading-relaxed',
        hasImage ? 'line-clamp-3' : 'line-clamp-6'
      ]}>
        {excerpt}
      </p>
    </div>
  </a>
</article>

<style>
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .line-clamp-6 {
    display: -webkit-box;
    -webkit-line-clamp: 6;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
